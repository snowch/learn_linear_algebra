
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Orthogonality &#8212; Learn Linear Algebra</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/15-orthogonality';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Determinants" href="16-determinants.html" />
    <link rel="prev" title="Projections" href="14-projections.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="00-start-here.html">
  
  
  
  
  
  
    <p class="title logo__title">Learn Linear Algebra</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="00-start-here.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01-vectors.html">Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-matrices.html">Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-gauss-method.html">Gauss Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="04-solution-sets.html">Solution Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-vector-spaces.html">Vector Spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="06-linear-dependence.html">Linear Dependence</a></li>
<li class="toctree-l1"><a class="reference internal" href="07-span.html">Span</a></li>
<li class="toctree-l1"><a class="reference internal" href="08-basis.html">Basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="09-subspaces.html">Subspaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="10-homogenous-ls.html">Homogenous</a></li>
<li class="toctree-l1"><a class="reference internal" href="11-matrixspaces.html">Matrix Spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="12-transformations.html">Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="13-nullspace.html">Nullspace</a></li>
<li class="toctree-l1"><a class="reference internal" href="14-projections.html">Projections</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Orthogonality</a></li>
<li class="toctree-l1"><a class="reference internal" href="16-determinants.html">Determinants</a></li>
<li class="toctree-l1"><a class="reference internal" href="17-eigenvalues.html">Eingenvalues</a></li>
<li class="toctree-l1"><a class="reference internal" href="18-matrix-decomp.html">Matrix Decompositions</a></li>
<li class="toctree-l1"><a class="reference internal" href="19-svd.html">SVD</a></li>
<li class="toctree-l1"><a class="reference internal" href="98-leftovers.html">Left overs</a></li>
<li class="toctree-l1"><a class="reference internal" href="99-quickref.html">Quick Reference</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/15-orthogonality.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Orthogonality</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-test-orthogonality">Example 1: Test orthogonality</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-orthogonal-vectors-in-2d">Example 2: Orthogonal Vectors in 2D</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-orthogonal-vectors-in-3d">Example 3: Orthogonal Vectors in 3D</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-4-orthogonal-basis">Example 4: Orthogonal Basis</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="orthogonality">
<h1>Orthogonality<a class="headerlink" href="#orthogonality" title="Link to this heading">#</a></h1>
<p>Let’s break down the key ideas of orthogonality in linear algebra, using SageMath to illustrate with examples and visualizations.</p>
<div style="background-color:yellow; padding: 5px 10px 0px 10px; border: 1px solid black;">
<p>Definitions: <strong>Orthogonality - The Essentials</strong></p>
<p><strong>Orthogonal Vectors:</strong> Two vectors are orthogonal (perpendicular) if their dot product is zero. Geometrically, they form a right angle.</p>
<p><strong>Orthogonal Sets:</strong> A set of vectors is orthogonal if every pair of distinct vectors in the set is orthogonal.</p>
<p><strong>Orthonormal Sets:</strong> A set of vectors is orthonormal if it’s orthogonal and each vector has a length (magnitude) of 1.</p>
<p><strong>Orthogonal Basis:</strong> An orthogonal (or orthonormal) basis for a vector space is a set of orthogonal (or orthonormal) vectors that span the entire space.</p>
<p><strong>Orthogonal Matrices:</strong> A square matrix is orthogonal if its columns (and rows) form an orthonormal set. Orthogonal matrices have special properties:
* Their inverse is equal to their transpose.
* They preserve lengths and angles when transforming vectors.</p>
</div><p><strong>SageMath Examples</strong></p>
<p>Let’s explore these concepts with SageMath code:</p>
<section id="example-1-test-orthogonality">
<h2>Example 1: Test orthogonality<a class="headerlink" href="#example-1-test-orthogonality" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the vectors</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>

<span class="c1"># Compute the dot product</span>
<span class="n">dot_product</span> <span class="o">=</span> <span class="n">v1</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>

<span class="c1"># Check if the dot product is zero</span>
<span class="k">if</span> <span class="n">dot_product</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The vectors v1 and v2 are orthogonal.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The vectors v1 and v2 are not orthogonal.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The vectors v1 and v2 are not orthogonal.
</pre></div>
</div>
</div>
</div>
<section id="example-2-orthogonal-vectors-in-2d">
<h3>Example 2: Orthogonal Vectors in 2D<a class="headerlink" href="#example-2-orthogonal-vectors-in-2d" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>  <span class="c1"># Define a symbolic variable for parameterization</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Example 2: Orthogonal Vectors in 2D</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vector u: </span><span class="si">{</span><span class="n">u</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vector v: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Calculate and display the dot product</span>
<span class="n">dot_product</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dot Product (u⋅v): </span><span class="si">{</span><span class="n">dot_product</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Visualize the vectors</span>
<span class="n">u_arrow</span> <span class="o">=</span> <span class="n">parametric_plot3d</span><span class="p">((</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">arrow_head</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">v_arrow</span> <span class="o">=</span> <span class="n">parametric_plot3d</span><span class="p">((</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">arrow_head</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">origin</span> <span class="o">=</span> <span class="n">point3d</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">u_arrow</span> <span class="o">+</span> <span class="n">v_arrow</span> <span class="o">+</span> <span class="n">origin</span>
<span class="n">plot</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Orthogonal Vectors in 2D&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Example 2: Orthogonal Vectors in 2D

Vector u: (3, -1)
Vector v: (1, 3)
Dot Product (u⋅v): 0
</pre></div>
</div>
<div class="output text_html">
<iframe srcdoc="&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;&lt;/title&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;meta name=viewport content=&quot;width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0&quot;&gt;
&lt;style&gt;

    body { margin: 0px; overflow: hidden; }

    #menu-container { position: absolute; bottom: 30px; right: 40px; cursor: default; }

    #menu-message { position: absolute; bottom: 0px; right: 0px; white-space: nowrap;
                    display: none; background-color: #F5F5F5; padding: 10px; }

    #menu-content { position: absolute; bottom: 0px; right: 0px;
                    display: none; background-color: #F5F5F5; border-bottom: 1px solid black;
                    border-right: 1px solid black; border-left: 1px solid black; }

    #menu-content div { border-top: 1px solid black; padding: 10px; white-space: nowrap; }

    #menu-content div:hover { background-color: #FEFEFE; }

    .dark-theme #menu-container { color: white; }

    .dark-theme #menu-message { background-color: #181818; }

    .dark-theme #menu-content { background-color: #181818; border-color: white; }

    .dark-theme #menu-content div { border-color: white; }

    .dark-theme #menu-content div:hover { background-color: #303030; }

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;script src=&quot;/nbextensions/threejs-sage/r122/three.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
  if ( !window.THREE ) document.write(&#x27; \
&lt;script src=&quot;https://cdn.jsdelivr.net/gh/sagemath/threejs-sage@r122/build/three.min.js&quot;&gt;&lt;\/script&gt; \
            &#x27;);
&lt;/script&gt;
        &lt;script&gt;// fat_lines.js

var _fatLines = [];

function _createFatLine( lineStrip, geometry, materialOptions ) {

    var vertexCount = geometry.vertices.length;
    var positions = [];
    for ( var i=0 ; i &lt; vertexCount ; i++ ) {
        var v = geometry.vertices[i];
        positions.push( v.x, v.y, v.z );
        // For a line strip, duplicate all but the first and last vertices.
        if ( lineStrip &amp;&amp; i &gt; 0 &amp;&amp; i &lt; vertexCount - 1 ) {
            positions.push( v.x, v.y, v.z );
        }
    }

    geometry = new THREE.LineSegmentsGeometry();
    geometry.setPositions( positions );

    var material = new THREE.LineMaterial( materialOptions );
    material.resolution = new THREE.Vector2( window.innerWidth, window.innerHeight );

    var line = new THREE.LineSegments2( geometry, material );
    line.computeLineDistances();
    line.scale.set( 1, 1, 1 );

    _fatLines.push( line );

    return line;

}

function createFatLineStrip( geometry, materialOptions ) {
    return _createFatLine( true, geometry, materialOptions );
}

function createFatLineSegments( geometry, materialOptions ) {
    return _createFatLine( false, geometry, materialOptions );
}

function rescaleFatLines() {
    var res = new THREE.Vector2( window.innerWidth, window.innerHeight );
    var n = _fatLines.length;
    for ( var i=0 ; i &lt; n ; i++ ) {
        _fatLines[i].material.resolution = res;
    }
}
&lt;/script&gt;
&lt;script&gt;

    var options = {&quot;animate&quot;: false, &quot;animationControls&quot;: true, &quot;aspectRatio&quot;: [1.0, 1.0, 1.0], &quot;autoScaling&quot;: [false, false, false], &quot;autoPlay&quot;: true, &quot;axes&quot;: false, &quot;axesLabels&quot;: [&quot;x&quot;, &quot;y&quot;, &quot;z&quot;], &quot;axesLabelsStyle&quot;: null, &quot;decimals&quot;: 2, &quot;delay&quot;: 20, &quot;frame&quot;: true, &quot;loop&quot;: true, &quot;projection&quot;: &quot;perspective&quot;, &quot;theme&quot;: &quot;light&quot;, &quot;viewpoint&quot;: false};
    var animate = options.animate;

    if ( options.theme === &#x27;dark&#x27; )
        document.body.className = &#x27;dark-theme&#x27;;

    var scene = new THREE.Scene();

    var renderer = new THREE.WebGLRenderer( { antialias: true, preserveDrawingBuffer: true } );
    renderer.setPixelRatio( window.devicePixelRatio );
    renderer.setSize( window.innerWidth, window.innerHeight );
    renderer.setClearColor( options.theme === &#x27;dark&#x27; ? 0 : 0xffffff, 1 );
    document.body.appendChild( renderer.domElement );

    var b = [{&quot;x&quot;:0.0, &quot;y&quot;:-1.0, &quot;z&quot;:0.0}, {&quot;x&quot;:3.0, &quot;y&quot;:3.0, &quot;z&quot;:0.0}]; // bounds

    if ( b[0].x === b[1].x ) {
        b[0].x -= 1;
        b[1].x += 1;
    }
    if ( b[0].y === b[1].y ) {
        b[0].y -= 1;
        b[1].y += 1;
    }
    if ( b[0].z === b[1].z ) {
        b[0].z -= 1;
        b[1].z += 1;
    }

    var rxRange = Math.sqrt( Math.pow( b[1].z - b[0].z, 2 )
                            + Math.pow( b[1].y - b[0].y, 2 ) );
    var ryRange = Math.sqrt( Math.pow( b[1].x - b[0].x, 2 )
                            + Math.pow( b[1].z - b[0].z, 2 ) );
    var rzRange = Math.sqrt( Math.pow( b[1].x - b[0].x, 2 )
                            + Math.pow( b[1].y - b[0].y, 2 ) );
    var xRange = b[1].x - b[0].x;
    var yRange = b[1].y - b[0].y;
    var zRange = b[1].z - b[0].z;

    var ar = options.aspectRatio;
    var a = [ ar[0], ar[1], ar[2] ]; // aspect multipliers

    var autoScaling = options.autoScaling;
    var autoAspect = 2.5;
    if ( xRange &gt; autoAspect * rxRange &amp;&amp; autoScaling[0] ) a[0] = autoAspect * rxRange / xRange;
    if ( yRange &gt; autoAspect * ryRange &amp;&amp; autoScaling[1] ) a[1] = autoAspect * ryRange / yRange;
    if ( zRange &gt; autoAspect * rzRange &amp;&amp; autoScaling[2] ) a[2] = autoAspect * rzRange / zRange;

    // Distance from (xMid,yMid,zMid) to any corner of the bounding box, after applying aspectRatio
    var midToCorner = Math.sqrt( a[0]*a[0]*xRange*xRange + a[1]*a[1]*yRange*yRange + a[2]*a[2]*zRange*zRange ) / 2;

    var xMid = ( b[0].x + b[1].x ) / 2;
    var yMid = ( b[0].y + b[1].y ) / 2;
    var zMid = ( b[0].z + b[1].z ) / 2;

    var box = new THREE.Geometry();
    box.vertices.push( new THREE.Vector3( a[0]*b[0].x, a[1]*b[0].y, a[2]*b[0].z ) );
    box.vertices.push( new THREE.Vector3( a[0]*b[1].x, a[1]*b[1].y, a[2]*b[1].z ) );
    var boxMesh = new THREE.Line( box );
    var boxColor = options.theme === &#x27;dark&#x27; ? &#x27;white&#x27; : &#x27;black&#x27;;
    if ( options.frame ) scene.add( new THREE.BoxHelper( boxMesh, boxColor ) );

    if ( options.axesLabels ) {

        var d = options.decimals; // decimals
        var offsetRatio = 0.1;
        var al = options.axesLabels;
        var als = options.axesLabelsStyle || [{}, {}, {}];

        var offset = offsetRatio * a[1]*( b[1].y - b[0].y );
        var xm = xMid.toFixed(d);
        if ( /^-0.?0*$/.test(xm) ) xm = xm.substr(1);
        addLabel( al[0] + &#x27;=&#x27; + xm, a[0]*xMid, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );
        addLabel( ( b[0].x ).toFixed(d), a[0]*b[0].x, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );
        addLabel( ( b[1].x ).toFixed(d), a[0]*b[1].x, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );

        var offset = offsetRatio * a[0]*( b[1].x - b[0].x );
        var ym = yMid.toFixed(d);
        if ( /^-0.?0*$/.test(ym) ) ym = ym.substr(1);
        addLabel( al[1] + &#x27;=&#x27; + ym, a[0]*b[1].x+offset, a[1]*yMid, a[2]*b[0].z, als[1] );
        addLabel( ( b[0].y ).toFixed(d), a[0]*b[1].x+offset, a[1]*b[0].y, a[2]*b[0].z, als[1] );
        addLabel( ( b[1].y ).toFixed(d), a[0]*b[1].x+offset, a[1]*b[1].y, a[2]*b[0].z, als[1] );

        var offset = offsetRatio * a[1]*( b[1].y - b[0].y );
        var zm = zMid.toFixed(d);
        if ( /^-0.?0*$/.test(zm) ) zm = zm.substr(1);
        addLabel( al[2] + &#x27;=&#x27; + zm, a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*zMid, als[2] );
        addLabel( ( b[0].z ).toFixed(d), a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*b[0].z, als[2] );
        addLabel( ( b[1].z ).toFixed(d), a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*b[1].z, als[2] );

    }

    function addLabel( text, x, y, z, style ) {

        var color = style.color || &#x27;black&#x27;;
        var fontSize = style.fontSize || 14;
        var fontFamily = style.fontFamily || &#x27;monospace&#x27;;
        var fontStyle = style.fontStyle || &#x27;normal&#x27;;
        var fontWeight = style.fontWeight || &#x27;normal&#x27;;
        var opacity = style.opacity || 1;

        if ( options.theme === &#x27;dark&#x27; )
            if ( color === &#x27;black&#x27; || color === &#x27;#000000&#x27; )
                color = &#x27;white&#x27;;

        if ( Array.isArray( fontStyle ) ) {
            fontFamily = fontFamily.map( function( f ) {
                // Need to put quotes around fonts that have whitespace in their names.
                return /\s/.test( f ) ? &#x27;&quot;&#x27; + f + &#x27;&quot;&#x27; : f;
            }).join(&#x27;, &#x27;);
        }

        var canvas = document.createElement( &#x27;canvas&#x27; );
        var context = canvas.getContext( &#x27;2d&#x27; );
        var pixelRatio = Math.round( window.devicePixelRatio );

        // For example: italic bold 20px &quot;Times New Roman&quot;, Georgia, serif
        var font = [fontStyle, fontWeight, fontSize + &#x27;px&#x27;, fontFamily].join(&#x27; &#x27;);

        context.font = font;
        var width = context.measureText( text ).width;
        var height = fontSize;

        // The dimensions of the canvas&#x27;s underlying image data need to be powers
        // of two in order for the resulting texture to support mipmapping.
        canvas.width = THREE.MathUtils.ceilPowerOfTwo( width * pixelRatio );
        canvas.height = THREE.MathUtils.ceilPowerOfTwo( height * pixelRatio );

        // Re-compute the unscaled dimensions after the power of two conversion.
        width = canvas.width / pixelRatio;
        height = canvas.height / pixelRatio;

        canvas.style.width = width + &#x27;px&#x27;;
        canvas.style.height = height + &#x27;px&#x27;;

        context.scale( pixelRatio, pixelRatio );
        context.fillStyle = color;
        context.font = font; // Must be set again after measureText.
        context.textAlign = &#x27;center&#x27;;
        context.textBaseline = &#x27;middle&#x27;;
        context.fillText( text, width/2, height/2 );

        var texture = new THREE.Texture( canvas );
        texture.needsUpdate = true;

        var materialOptions = { map: texture, sizeAttenuation: false, depthWrite: false };
        if ( opacity &lt; 1 ) {
            // Setting opacity=1 would cause the texture&#x27;s alpha component to be
            // discarded, giving the text a black background instead of the
            // background being transparent.
            materialOptions.opacity = opacity;
        }
        var sprite = new THREE.Sprite( new THREE.SpriteMaterial( materialOptions ) );
        sprite.position.set( x, y, z );

        // Scaling factor, chosen somewhat arbitrarily so that the size of the text
        // is consistent with previously generated plots.
        var scale = 1/625;
        if ( options.projection === &#x27;orthographic&#x27; ) {
            scale = midToCorner/256; // Needs to scale along with the plot itself.
        }
        sprite.scale.set( scale * width, scale * height, 1 );

        scene.add( sprite );

        return sprite;

    }

    if ( options.axes ) scene.add( new THREE.AxesHelper( Math.min( a[0]*b[1].x, a[1]*b[1].y, a[2]*b[1].z ) ) );

    var camera = createCamera();
    camera.up.set( 0, 0, 1 );
    camera.position.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );

    // camera is positioned so that the line from the camera to the center
    // of the bounding sphere of the objects makes an angle of 60 degrees with x-axis
    // and an angle of 30 degrees with z-axis and the field of view of the camera looking
    // at the center has an angle of 45 degrees.
    const sin8 = Math.sin(Math.PI / 8);
    const sin5 = Math.sin(Math.PI / 5);
    const cos5 = Math.cos(Math.PI / 5);
    const sin3 = Math.sin(Math.PI / 3);
    const cos3 = Math.cos(Math.PI / 3);
    var r = midToCorner / sin8;
    var offset = new THREE.Vector3( r * sin3 * cos5, r * sin3 * sin5, r * cos3 );

    if ( options.viewpoint ) {

        var aa = options.viewpoint;
        var axis = new THREE.Vector3( aa[0][0], aa[0][1], aa[0][2] ).normalize();
        var angle = aa[1] * Math.PI / 180;
        var q = new THREE.Quaternion().setFromAxisAngle( axis, angle ).inverse();

        offset.set( 0, 0, offset.length() );
        offset.applyQuaternion( q );

    }

    camera.position.add( offset );

    function createCamera() {

        var aspect = window.innerWidth / window.innerHeight;

        // Scale the near and far clipping planes along with the overall plot size.
        var nearClip = 0.01 * midToCorner;
        var farClip = 100 * midToCorner;

        if ( options.projection === &#x27;orthographic&#x27; ) {
            var camera = new THREE.OrthographicCamera( -1, 1, 1, -1, -farClip, farClip );
            updateCameraAspect( camera, aspect );
            return camera;
        }

        return new THREE.PerspectiveCamera( 45, aspect, nearClip, farClip );

    }

    function updateCameraAspect( camera, aspect ) {

        if ( camera.isPerspectiveCamera ) {
            camera.aspect = aspect;
        } else if ( camera.isOrthographicCamera ) {
            // Fit the camera frustum to the bounding box&#x27;s diagonal so that the entire plot fits
            // within at the default zoom level and camera position.
            if ( aspect &gt; 1 ) { // Wide window
                camera.top = midToCorner;
                camera.right = midToCorner * aspect;
            } else { // Tall or square window
                camera.top = midToCorner / aspect;
                camera.right = midToCorner;
            }
            camera.bottom = -camera.top;
            camera.left = -camera.right;
        }

        camera.updateProjectionMatrix();

    }

    var lights = [{&quot;x&quot;:-5, &quot;y&quot;:3, &quot;z&quot;:0, &quot;color&quot;:&quot;#7f7f7f&quot;, &quot;parent&quot;:&quot;camera&quot;}];
    for ( var i=0 ; i &lt; lights.length ; i++ ) {
        var light = new THREE.DirectionalLight( lights[i].color, 1 );
        light.position.set( a[0]*lights[i].x, a[1]*lights[i].y, a[2]*lights[i].z );
        if ( lights[i].parent === &#x27;camera&#x27; ) {
            light.target.position.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );
            scene.add( light.target );
            camera.add( light );
        } else scene.add( light );
    }
    scene.add( camera );

    var ambient = {&quot;color&quot;:&quot;#7f7f7f&quot;};
    scene.add( new THREE.AmbientLight( ambient.color, 1 ) );

    var controls = new THREE.OrbitControls( camera, renderer.domElement );
    controls.target.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );
    controls.addEventListener( &#x27;change&#x27;, function() { if ( !animate ) render(); } );

    window.addEventListener( &#x27;resize&#x27;, function() {

        renderer.setSize( window.innerWidth, window.innerHeight );
        updateCameraAspect( camera, window.innerWidth / window.innerHeight );
        if ( window.rescaleFatLines ) rescaleFatLines();
        if ( !animate ) render();

    } );

    var texts = [];
    for ( var i=0 ; i &lt; texts.length ; i++ ) addText( texts[i] );

    function addText( json ) {
        var sprite = addLabel( json.text, a[0]*json.x, a[1]*json.y, a[2]*json.z, json );
        sprite.userData = json;
    }

    var points = [{&quot;point&quot;: [0.0, 0.0, 0.0], &quot;size&quot;: 20.0, &quot;color&quot;: &quot;#6666ff&quot;, &quot;opacity&quot;: 1.0}];
    for ( var i=0 ; i &lt; points.length ; i++ ) addPoint( points[i] );

    function addPoint( json ) {

        var geometry = new THREE.Geometry();
        var v = json.point;
        geometry.vertices.push( new THREE.Vector3( a[0]*v[0], a[1]*v[1], a[2]*v[2] ) );

        var canvas = document.createElement( &#x27;canvas&#x27; );
        canvas.width = 128;
        canvas.height = 128;

        var context = canvas.getContext( &#x27;2d&#x27; );
        context.arc( 64, 64, 64, 0, 2 * Math.PI );
        context.fillStyle = json.color;
        context.fill();

        var texture = new THREE.Texture( canvas );
        texture.needsUpdate = true;

        var transparent = json.opacity &lt; 1 ? true : false;
        var size = camera.isOrthographicCamera ? json.size : json.size/100;
        var material = new THREE.PointsMaterial( { size: size, map: texture,
                                                   transparent: transparent, opacity: json.opacity,
                                                   alphaTest: .1 } );

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var mesh = new THREE.Points( geometry, material );
        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    var lines = [{&quot;points&quot;: [[0.0, -0.0, 0.0], [0.04054054054054054, -0.013513513513513514, 0.0], [0.08108108108108109, -0.02702702702702703, 0.0], [0.12162162162162163, -0.04054054054054054, 0.0], [0.16216216216216217, -0.05405405405405406, 0.0], [0.20270270270270271, -0.06756756756756757, 0.0], [0.24324324324324326, -0.08108108108108109, 0.0], [0.28378378378378377, -0.0945945945945946, 0.0], [0.32432432432432434, -0.10810810810810811, 0.0], [0.3648648648648649, -0.12162162162162163, 0.0], [0.40540540540540543, -0.13513513513513514, 0.0], [0.44594594594594594, -0.14864864864864866, 0.0], [0.4864864864864865, -0.16216216216216217, 0.0], [0.5270270270270271, -0.17567567567567569, 0.0], [0.5675675675675675, -0.1891891891891892, 0.0], [0.6081081081081081, -0.20270270270270271, 0.0], [0.6486486486486487, -0.21621621621621623, 0.0], [0.6891891891891893, -0.22972972972972974, 0.0], [0.7297297297297298, -0.24324324324324326, 0.0], [0.7702702702702704, -0.2567567567567568, 0.0], [0.8108108108108109, -0.2702702702702703, 0.0], [0.8513513513513513, -0.28378378378378377, 0.0], [0.8918918918918918, -0.29729729729729726, 0.0], [0.9324324324324322, -0.31081081081081074, 0.0], [0.9729729729729727, -0.32432432432432423, 0.0], [1.0135135135135132, -0.3378378378378377, 0.0], [1.0540540540540535, -0.3513513513513512, 0.0], [1.094594594594594, -0.3648648648648647, 0.0], [1.1351351351351346, -0.3783783783783782, 0.0], [1.175675675675675, -0.39189189189189166, 0.0], [1.2162162162162153, -0.40540540540540515, 0.0], [1.256756756756756, -0.41891891891891864, 0.0], [1.2972972972972965, -0.4324324324324321, 0.0], [1.3378378378378368, -0.4459459459459456, 0.0], [1.3783783783783772, -0.4594594594594591, 0.0], [1.4189189189189177, -0.4729729729729726, 0.0], [1.4594594594594583, -0.48648648648648607, 0.0], [1.4999999999999987, -0.49999999999999956, 0.0], [1.540540540540539, -0.513513513513513, 0.0], [1.5810810810810796, -0.5270270270270265, 0.0], [1.6216216216216202, -0.54054054054054, 0.0], [1.6621621621621605, -0.5540540540540535, 0.0], [1.7027027027027009, -0.567567567567567, 0.0], [1.7432432432432414, -0.5810810810810805, 0.0], [1.783783783783782, -0.594594594594594, 0.0], [1.8243243243243223, -0.6081081081081074, 0.0], [1.8648648648648627, -0.6216216216216209, 0.0], [1.9054054054054033, -0.6351351351351344, 0.0], [1.9459459459459438, -0.6486486486486479, 0.0], [1.9864864864864842, -0.6621621621621614, 0.0], [2.0270270270270245, -0.6756756756756749, 0.0], [2.067567567567565, -0.6891891891891884, 0.0], [2.1081081081081057, -0.7027027027027019, 0.0], [2.148648648648646, -0.7162162162162153, 0.0], [2.1891891891891864, -0.7297297297297288, 0.0], [2.229729729729727, -0.7432432432432423, 0.0], [2.2702702702702675, -0.7567567567567558, 0.0], [2.310810810810808, -0.7702702702702693, 0.0], [2.351351351351348, -0.7837837837837828, 0.0], [2.3918918918918886, -0.7972972972972963, 0.0], [2.4324324324324293, -0.8108108108108097, 0.0], [2.4729729729729697, -0.8243243243243232, 0.0], [2.51351351351351, -0.8378378378378367, 0.0], [2.554054054054051, -0.8513513513513502, 0.0], [2.594594594594591, -0.8648648648648637, 0.0], [2.6351351351351315, -0.8783783783783772, 0.0], [2.675675675675672, -0.8918918918918907, 0.0], [2.7162162162162122, -0.9054054054054042, 0.0], [2.756756756756753, -0.9189189189189176, 0.0], [2.7972972972972934, -0.9324324324324311, 0.0], [2.8378378378378337, -0.9459459459459446, 0.0], [2.8783783783783745, -0.9594594594594581, 0.0], [2.918918918918915, -0.9729729729729716, 0.0], [2.959459459459455, -0.9864864864864851, 0.0]], &quot;color&quot;: &quot;#0000ff&quot;, &quot;opacity&quot;: 1.0, &quot;linewidth&quot;: 3.0}, {&quot;points&quot;: [[0.0, 0.0, 0.0], [0.013513513513513514, 0.04054054054054054, 0.0], [0.02702702702702703, 0.08108108108108109, 0.0], [0.04054054054054054, 0.12162162162162163, 0.0], [0.05405405405405406, 0.16216216216216217, 0.0], [0.06756756756756757, 0.20270270270270271, 0.0], [0.08108108108108109, 0.24324324324324326, 0.0], [0.0945945945945946, 0.28378378378378377, 0.0], [0.10810810810810811, 0.32432432432432434, 0.0], [0.12162162162162163, 0.3648648648648649, 0.0], [0.13513513513513514, 0.40540540540540543, 0.0], [0.14864864864864866, 0.44594594594594594, 0.0], [0.16216216216216217, 0.4864864864864865, 0.0], [0.17567567567567569, 0.5270270270270271, 0.0], [0.1891891891891892, 0.5675675675675675, 0.0], [0.20270270270270271, 0.6081081081081081, 0.0], [0.21621621621621623, 0.6486486486486487, 0.0], [0.22972972972972974, 0.6891891891891893, 0.0], [0.24324324324324326, 0.7297297297297298, 0.0], [0.2567567567567568, 0.7702702702702704, 0.0], [0.2702702702702703, 0.8108108108108109, 0.0], [0.28378378378378377, 0.8513513513513513, 0.0], [0.29729729729729726, 0.8918918918918918, 0.0], [0.31081081081081074, 0.9324324324324322, 0.0], [0.32432432432432423, 0.9729729729729727, 0.0], [0.3378378378378377, 1.0135135135135132, 0.0], [0.3513513513513512, 1.0540540540540535, 0.0], [0.3648648648648647, 1.094594594594594, 0.0], [0.3783783783783782, 1.1351351351351346, 0.0], [0.39189189189189166, 1.175675675675675, 0.0], [0.40540540540540515, 1.2162162162162153, 0.0], [0.41891891891891864, 1.256756756756756, 0.0], [0.4324324324324321, 1.2972972972972965, 0.0], [0.4459459459459456, 1.3378378378378368, 0.0], [0.4594594594594591, 1.3783783783783772, 0.0], [0.4729729729729726, 1.4189189189189177, 0.0], [0.48648648648648607, 1.4594594594594583, 0.0], [0.49999999999999956, 1.4999999999999987, 0.0], [0.513513513513513, 1.540540540540539, 0.0], [0.5270270270270265, 1.5810810810810796, 0.0], [0.54054054054054, 1.6216216216216202, 0.0], [0.5540540540540535, 1.6621621621621605, 0.0], [0.567567567567567, 1.7027027027027009, 0.0], [0.5810810810810805, 1.7432432432432414, 0.0], [0.594594594594594, 1.783783783783782, 0.0], [0.6081081081081074, 1.8243243243243223, 0.0], [0.6216216216216209, 1.8648648648648627, 0.0], [0.6351351351351344, 1.9054054054054033, 0.0], [0.6486486486486479, 1.9459459459459438, 0.0], [0.6621621621621614, 1.9864864864864842, 0.0], [0.6756756756756749, 2.0270270270270245, 0.0], [0.6891891891891884, 2.067567567567565, 0.0], [0.7027027027027019, 2.1081081081081057, 0.0], [0.7162162162162153, 2.148648648648646, 0.0], [0.7297297297297288, 2.1891891891891864, 0.0], [0.7432432432432423, 2.229729729729727, 0.0], [0.7567567567567558, 2.2702702702702675, 0.0], [0.7702702702702693, 2.310810810810808, 0.0], [0.7837837837837828, 2.351351351351348, 0.0], [0.7972972972972963, 2.3918918918918886, 0.0], [0.8108108108108097, 2.4324324324324293, 0.0], [0.8243243243243232, 2.4729729729729697, 0.0], [0.8378378378378367, 2.51351351351351, 0.0], [0.8513513513513502, 2.554054054054051, 0.0], [0.8648648648648637, 2.594594594594591, 0.0], [0.8783783783783772, 2.6351351351351315, 0.0], [0.8918918918918907, 2.675675675675672, 0.0], [0.9054054054054042, 2.7162162162162122, 0.0], [0.9189189189189176, 2.756756756756753, 0.0], [0.9324324324324311, 2.7972972972972934, 0.0], [0.9459459459459446, 2.8378378378378337, 0.0], [0.9594594594594581, 2.8783783783783745, 0.0], [0.9729729729729716, 2.918918918918915, 0.0], [0.9864864864864851, 2.959459459459455, 0.0]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0, &quot;linewidth&quot;: 3.0}];
    for ( var i=0 ; i &lt; lines.length ; i++ ) addLine( lines[i] );

    function addLine( json ) {

        var geometry = new THREE.Geometry();
        for ( var i=0 ; i &lt; json.points.length ; i++ ) {
            var v = json.points[i];
            geometry.vertices.push( new THREE.Vector3( a[0]*v[0], a[1]*v[1], a[2]*v[2] ) );
        }

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var transparent = json.opacity &lt; 1 ? true : false;
        var materialOptions = { color: json.color, linewidth: json.linewidth,
                                transparent: transparent, opacity: json.opacity };

        var mesh;
        if ( json.linewidth &gt; 1 &amp;&amp; window.createFatLineStrip ) {
            mesh = createFatLineStrip( geometry, materialOptions );
        } else {
            var material = new THREE.LineBasicMaterial( materialOptions );
            mesh = new THREE.Line( geometry, material );
        }

        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    var surfaces = [{&quot;vertices&quot;: [{&quot;x&quot;: 3.0, &quot;y&quot;: -1.0, &quot;z&quot;: 2.6166710909059414e-18}, {&quot;x&quot;: 2.9621347285535142, &quot;y&quot;: -0.9784606792043078, &quot;z&quot;: -0.011460146641940448}, {&quot;x&quot;: 2.9637328076488725, &quot;y&quot;: -0.9736664419182336, &quot;z&quot;: 0.004504504504504976}, {&quot;x&quot;: 2.9568395184992187, &quot;y&quot;: -0.9943463093671946, &quot;z&quot;: -0.011587264645282145}, {&quot;x&quot;: 2.955164977803452, &quot;y&quot;: -0.9993699314544949, &quot;z&quot;: 0.004298823254516087}, {&quot;x&quot;: 2.959425264792219, &quot;y&quot;: -0.9865890704881944, &quot;z&quot;: 0.014244083528201529}, {&quot;x&quot;: 2.959459459459455, &quot;y&quot;: -0.9864864864864851, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6], [1, 3, 6], [3, 4, 6], [4, 5, 6], [5, 2, 6]], &quot;color&quot;: &quot;#0000ff&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 1.0, &quot;y&quot;: 3.0, &quot;z&quot;: 2.6166710909059414e-18}, {&quot;x&quot;: 0.9973585361989037, &quot;y&quot;: 2.955835442888649, &quot;z&quot;: -0.008459943691081948}, {&quot;x&quot;: 0.9822131382970679, &quot;y&quot;: 2.960883908855928, &quot;z&quot;: -0.013513513513514928}, {&quot;x&quot;: 0.9974791309255554, &quot;y&quot;: 2.9557952446464317, &quot;z&quot;: 0.00828498076951604}, {&quot;x&quot;: 0.9824082646636545, &quot;y&quot;: 2.960818866733732, &quot;z&quot;: 0.01358034340278212}, {&quot;x&quot;: 0.9729733623472439, &quot;y&quot;: 2.9639638341725356, &quot;z&quot;: 0.00010813303229871392}, {&quot;x&quot;: 0.9864864864864851, &quot;y&quot;: 2.959459459459455, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6], [1, 3, 6], [3, 4, 6], [4, 5, 6], [5, 2, 6]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}];
    for ( var i=0 ; i &lt; surfaces.length ; i++ ) addSurface( surfaces[i] );

    function addSurface( json ) {

        var useFaceColors = &#x27;faceColors&#x27; in json ? true : false;

        var geometry = new THREE.Geometry();
        for ( var i=0 ; i &lt; json.vertices.length ; i++ ) {
            var v = json.vertices[i];
            geometry.vertices.push( new THREE.Vector3( a[0]*v.x, a[1]*v.y, a[2]*v.z ) );
        }
        for ( var i=0 ; i &lt; json.faces.length ; i++ ) {
            var f = json.faces[i];
            for ( var j=0 ; j &lt; f.length - 2 ; j++ ) {
                var face = new THREE.Face3( f[0], f[j+1], f[j+2] );
                if ( useFaceColors ) face.color.set( json.faceColors[i] );
                geometry.faces.push( face );
            }
        }
        geometry.computeVertexNormals();

        var side = json.singleSide ? THREE.FrontSide : THREE.DoubleSide;
        var transparent = json.opacity &lt; 1 ? true : false;
        var depthWrite = &#x27;depthWrite&#x27; in json ? json.depthWrite : !transparent;
        var flatShading = json.useFlatShading ? json.useFlatShading : false;

        var material = new THREE.MeshPhongMaterial( { side: side,
                                     color: useFaceColors ? &#x27;white&#x27; : json.color,
                                     vertexColors: useFaceColors ? THREE.FaceColors : THREE.NoColors,
                                     transparent: transparent, opacity: json.opacity,
                                     shininess: 20, flatShading: flatShading,
                                     depthWrite: depthWrite } );

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var mesh = new THREE.Mesh( geometry, material );
        mesh.position.set( c.x, c.y, c.z );
        if ( transparent &amp;&amp; json.renderOrder ) mesh.renderOrder = json.renderOrder;
        mesh.userData = json;
        scene.add( mesh );

        if ( json.showMeshGrid ) addSurfaceMeshGrid( json );

    }

    function addSurfaceMeshGrid( json ) {

        var geometry = new THREE.Geometry();

        for ( var i=0 ; i &lt; json.faces.length ; i++ ) {
            var f = json.faces[i];
            for ( var j=0 ; j &lt; f.length ; j++ ) {
                var k = j === f.length-1 ? 0 : j+1;
                var v1 = json.vertices[f[j]];
                var v2 = json.vertices[f[k]];
                // vertices in opposite directions on neighboring faces
                var nudge = f[j] &lt; f[k] ? .0005*zRange : -.0005*zRange;
                geometry.vertices.push( new THREE.Vector3( a[0]*v1.x, a[1]*v1.y, a[2]*(v1.z+nudge) ) );
                geometry.vertices.push( new THREE.Vector3( a[0]*v2.x, a[1]*v2.y, a[2]*(v2.z+nudge) ) );
            }
        }

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var gridColor = options.theme === &#x27;dark&#x27; ? &#x27;white&#x27; : &#x27;black&#x27;;
        var linewidth = json.linewidth || 1;
        var materialOptions = { color: gridColor, linewidth: linewidth };

        var mesh;
        if ( linewidth &gt; 1 &amp;&amp; window.createFatLineSegments ) {
            mesh = createFatLineSegments( geometry, materialOptions );
        } else {
            var material = new THREE.LineBasicMaterial( materialOptions );
            mesh = new THREE.LineSegments( geometry, material );
        }

        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    function render() {

        if ( window.updateAnimation ) animate = updateAnimation();
        if ( animate ) requestAnimationFrame( render );

        renderer.render( scene, camera );

    }

    render();
    controls.update();
    if ( !animate ) render();


    // menu functions

    function toggleMenu() {

        var m = document.getElementById( &#x27;menu-content&#x27; );
        if ( m.style.display === &#x27;block&#x27; ) m.style.display = &#x27;none&#x27;
        else m.style.display = &#x27;block&#x27;;

    }


    function saveAsPNG() {

        var a = document.body.appendChild( document.createElement( &#x27;a&#x27; ) );
        a.href = renderer.domElement.toDataURL( &#x27;image/png&#x27; );
        a.download = &#x27;screenshot&#x27;;
        a.click();

    }

    function saveAsHTML() {

        toggleMenu(); // otherwise visible in output
        event.stopPropagation();

        var blob = new Blob( [ &#x27;&lt;!DOCTYPE html&gt;\n&#x27; + document.documentElement.outerHTML ] );
        var a = document.body.appendChild( document.createElement( &#x27;a&#x27; ) );
        a.href = window.URL.createObjectURL( blob );
        a.download = suggestFilename();
        a.click();

        function suggestFilename() {
            if ( !document.title ) {
                return &#x27;graphic.html&#x27;;
            } else if ( /\.html?$/i.test( document.title ) ) {
                return document.title; // already ends in .htm or .html
            } else {
                return document.title + &#x27;.html&#x27;;
            }
        }

    }

    function getViewpoint() {

        function roundTo( x, n ) { return +x.toFixed(n); }

        var v = camera.quaternion.inverse();
        var r = Math.sqrt( v.x*v.x + v.y*v.y + v.z*v.z );
        var axis = [ roundTo( v.x / r, 4 ), roundTo( v.y / r, 4 ), roundTo( v.z / r, 4 ) ];
        var angle = roundTo( 2 * Math.atan2( r, v.w ) * 180 / Math.PI, 2 );

        var textArea = document.createElement( &#x27;textarea&#x27; );
        textArea.textContent = JSON.stringify( axis ) + &#x27;,&#x27; + angle;
        textArea.style.csstext = &#x27;position: absolute; top: -100%&#x27;;
        document.body.append( textArea );
        textArea.select();
        document.execCommand( &#x27;copy&#x27; );

        var m = document.getElementById( &#x27;menu-message&#x27; );
        m.innerHTML = &#x27;Viewpoint copied to clipboard&#x27;;
        m.style.display = &#x27;block&#x27;;
        setTimeout( function() { m.style.display = &#x27;none&#x27;; }, 2000 );

    }

    function getCamera() {

        function roundTo( x, n ) { return +x.toFixed(n); }

        var pos = camera.position;
        var pos_r = [ roundTo( pos.x, 4 ), roundTo( pos.y, 4 ), roundTo( pos.z, 4 ) ];
   //     var up = camera.up; // up is always (0,0,1)
        var textArea = document.createElement(&#x27;textarea&#x27;);
        var cam_position = JSON.stringify(pos_r);
        textArea.textContent = &#x27;,camera_position=&#x27; + cam_position;
        textArea.style.csstext = &#x27;position: absolute; top: -100%&#x27;;
        document.body.append( textArea );
        textArea.select();
        document.execCommand( &#x27;copy&#x27; );

        var m = document.getElementById( &#x27;menu-message&#x27; );
        m.innerHTML = &#x27;Camera position &#x27;+ cam_position+&#x27; copied to clipboard&#x27;;
        m.style.display = &#x27;block&#x27;;
        setTimeout( function() { m.style.display = &#x27;none&#x27;; }, 2000 );

    }

&lt;/script&gt;

&lt;div id=&quot;menu-container&quot; onclick=&quot;toggleMenu()&quot;&gt;&amp;#x24d8;
&lt;div id=&quot;menu-message&quot;&gt;&lt;/div&gt;
&lt;div id=&quot;menu-content&quot;&gt;
&lt;div onclick=&quot;saveAsPNG()&quot;&gt;Save as PNG&lt;/div&gt;
&lt;div onclick=&quot;saveAsHTML()&quot;&gt;Save as HTML&lt;/div&gt;
&lt;div onclick=&quot;getCamera()&quot;&gt;Get camera&lt;/div&gt;
&lt;div onclick=&quot;getViewpoint()&quot;&gt;Get viewpoint&lt;/div&gt;
&lt;div&gt;Close Menu&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;/body&gt;
&lt;/html&gt;
"
        width="100%"
        height="400"
        style="border: 0;">
</iframe>
</div></div>
</div>
<p style="text-align: center;">
    (You can interactively rotate, zoom, and pan the above 3D plots using the mouse)
</p><p>Let’s break down what Example 1 is doing and why it’s important for understanding orthogonality.</p>
<p>Here’s what’s happening in this code snippet:</p>
<ol class="arabic">
<li><p><strong>Defining Vectors:</strong></p>
<ul class="simple">
<li><p>We define two vectors <code class="docutils literal notranslate"><span class="pre">u</span> <span class="pre">=</span> <span class="pre">[3,</span> <span class="pre">-1]</span></code> and <code class="docutils literal notranslate"><span class="pre">v</span> <span class="pre">=</span> <span class="pre">[1,</span> <span class="pre">3]</span></code>. These are two-dimensional vectors, meaning they exist on a plane (like the x-y coordinate plane).</p></li>
</ul>
</li>
<li><p><strong>Calculating Dot Product:</strong></p>
<ul>
<li><p>We calculate the dot product of the two vectors using the <code class="docutils literal notranslate"><span class="pre">dot_product</span></code> method. The dot product is a fundamental operation in linear algebra.  It’s calculated as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>u ⋅ v = u[0] * v[0] + u[1] * v[1] = (3 * 1) + (-1 * 3) = 0
</pre></div>
</div>
</li>
</ul>
</li>
<li><p><strong>Displaying the Dot Product:</strong></p>
<ul class="simple">
<li><p>The code prints the calculated dot product, which in this case is 0.</p></li>
</ul>
</li>
<li><p><strong>Visualizing the Vectors:</strong></p>
<ul class="simple">
<li><p>We create a 3D plot to visualize the vectors, even though they are in 2D. This is done by adding a third coordinate (z=0) to each vector to place them in the x-y plane of the 3D space.</p></li>
<li><p>The arrows are drawn using <code class="docutils literal notranslate"><span class="pre">parametric_plot3d</span></code> to represent the vectors.</p></li>
<li><p>The origin (0, 0, 0) is also added for reference.</p></li>
<li><p>The plot is displayed, making it easy to see that the vectors form a right angle (90 degrees).</p></li>
</ul>
</li>
</ol>
<p><strong>Why Example 2 is Important for Orthogonality</strong></p>
<ul class="simple">
<li><p><strong>Core Concept:</strong> This example demonstrates the core concept of orthogonality: two vectors are orthogonal if and only if their dot product is zero. This is the fundamental mathematical definition of perpendicularity.</p></li>
<li><p><strong>Geometric Intuition:</strong> The visualization reinforces the geometric interpretation of orthogonality. By seeing the vectors form a right angle in the plot, you gain an intuitive understanding of what it means for vectors to be perpendicular.</p></li>
<li><p><strong>Foundation for Applications:</strong> Orthogonality is a key concept that underlies many applications in linear algebra, including:</p>
<ul>
<li><p><strong>Orthogonal Projections:</strong> Finding the closest point in a subspace to a given vector.</p></li>
<li><p><strong>Least Squares:</strong> Finding the best-fit line or curve to a set of data points.</p></li>
<li><p><strong>Orthogonal Matrices:</strong>  Matrices that preserve lengths and angles, used in various transformations and decompositions.</p></li>
</ul>
</li>
<li><p><strong>Building Block:</strong> Understanding orthogonality in 2D is a stepping stone to understanding it in higher dimensions. The same principle of the dot product being zero applies to orthogonal vectors in any dimension.</p></li>
</ul>
</section>
<section id="example-3-orthogonal-vectors-in-3d">
<h3>Example 3: Orthogonal Vectors in 3D<a class="headerlink" href="#example-3-orthogonal-vectors-in-3d" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Example 3: Orthogonal Vectors in 3D</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vector u: </span><span class="si">{</span><span class="n">u</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vector v: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Calculate and display the dot product</span>
<span class="n">dot_product</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dot Product (u⋅v): </span><span class="si">{</span><span class="n">dot_product</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Visualize the vectors (using parametric_plot3d is preferred in SageMath 10.3)</span>
<span class="n">u_arrow</span> <span class="o">=</span> <span class="n">parametric_plot3d</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">arrow_head</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">v_arrow</span> <span class="o">=</span> <span class="n">parametric_plot3d</span><span class="p">(</span><span class="n">v</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">arrow_head</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">origin</span> <span class="o">=</span> <span class="n">point3d</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">u_arrow</span> <span class="o">+</span> <span class="n">v_arrow</span> <span class="o">+</span> <span class="n">origin</span>
<span class="n">plot</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Orthogonal Vectors in 3D&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Example 3: Orthogonal Vectors in 3D

Vector u: (1, 2, 3)
Vector v: (-6, 3, 2)
Dot Product (u⋅v): 6
</pre></div>
</div>
<div class="output text_html">
<iframe srcdoc="&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;&lt;/title&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;meta name=viewport content=&quot;width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0&quot;&gt;
&lt;style&gt;

    body { margin: 0px; overflow: hidden; }

    #menu-container { position: absolute; bottom: 30px; right: 40px; cursor: default; }

    #menu-message { position: absolute; bottom: 0px; right: 0px; white-space: nowrap;
                    display: none; background-color: #F5F5F5; padding: 10px; }

    #menu-content { position: absolute; bottom: 0px; right: 0px;
                    display: none; background-color: #F5F5F5; border-bottom: 1px solid black;
                    border-right: 1px solid black; border-left: 1px solid black; }

    #menu-content div { border-top: 1px solid black; padding: 10px; white-space: nowrap; }

    #menu-content div:hover { background-color: #FEFEFE; }

    .dark-theme #menu-container { color: white; }

    .dark-theme #menu-message { background-color: #181818; }

    .dark-theme #menu-content { background-color: #181818; border-color: white; }

    .dark-theme #menu-content div { border-color: white; }

    .dark-theme #menu-content div:hover { background-color: #303030; }

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;script src=&quot;/nbextensions/threejs-sage/r122/three.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
  if ( !window.THREE ) document.write(&#x27; \
&lt;script src=&quot;https://cdn.jsdelivr.net/gh/sagemath/threejs-sage@r122/build/three.min.js&quot;&gt;&lt;\/script&gt; \
            &#x27;);
&lt;/script&gt;
        &lt;script&gt;// fat_lines.js

var _fatLines = [];

function _createFatLine( lineStrip, geometry, materialOptions ) {

    var vertexCount = geometry.vertices.length;
    var positions = [];
    for ( var i=0 ; i &lt; vertexCount ; i++ ) {
        var v = geometry.vertices[i];
        positions.push( v.x, v.y, v.z );
        // For a line strip, duplicate all but the first and last vertices.
        if ( lineStrip &amp;&amp; i &gt; 0 &amp;&amp; i &lt; vertexCount - 1 ) {
            positions.push( v.x, v.y, v.z );
        }
    }

    geometry = new THREE.LineSegmentsGeometry();
    geometry.setPositions( positions );

    var material = new THREE.LineMaterial( materialOptions );
    material.resolution = new THREE.Vector2( window.innerWidth, window.innerHeight );

    var line = new THREE.LineSegments2( geometry, material );
    line.computeLineDistances();
    line.scale.set( 1, 1, 1 );

    _fatLines.push( line );

    return line;

}

function createFatLineStrip( geometry, materialOptions ) {
    return _createFatLine( true, geometry, materialOptions );
}

function createFatLineSegments( geometry, materialOptions ) {
    return _createFatLine( false, geometry, materialOptions );
}

function rescaleFatLines() {
    var res = new THREE.Vector2( window.innerWidth, window.innerHeight );
    var n = _fatLines.length;
    for ( var i=0 ; i &lt; n ; i++ ) {
        _fatLines[i].material.resolution = res;
    }
}
&lt;/script&gt;
&lt;script&gt;

    var options = {&quot;animate&quot;: false, &quot;animationControls&quot;: true, &quot;aspectRatio&quot;: [1.0, 1.0, 1.0], &quot;autoScaling&quot;: [false, false, false], &quot;autoPlay&quot;: true, &quot;axes&quot;: false, &quot;axesLabels&quot;: [&quot;x&quot;, &quot;y&quot;, &quot;z&quot;], &quot;axesLabelsStyle&quot;: null, &quot;decimals&quot;: 2, &quot;delay&quot;: 20, &quot;frame&quot;: true, &quot;loop&quot;: true, &quot;projection&quot;: &quot;perspective&quot;, &quot;theme&quot;: &quot;light&quot;, &quot;viewpoint&quot;: false};
    var animate = options.animate;

    if ( options.theme === &#x27;dark&#x27; )
        document.body.className = &#x27;dark-theme&#x27;;

    var scene = new THREE.Scene();

    var renderer = new THREE.WebGLRenderer( { antialias: true, preserveDrawingBuffer: true } );
    renderer.setPixelRatio( window.devicePixelRatio );
    renderer.setSize( window.innerWidth, window.innerHeight );
    renderer.setClearColor( options.theme === &#x27;dark&#x27; ? 0 : 0xffffff, 1 );
    document.body.appendChild( renderer.domElement );

    var b = [{&quot;x&quot;:-6.0, &quot;y&quot;:0.0, &quot;z&quot;:0.0}, {&quot;x&quot;:1.0, &quot;y&quot;:3.0, &quot;z&quot;:3.0}]; // bounds

    if ( b[0].x === b[1].x ) {
        b[0].x -= 1;
        b[1].x += 1;
    }
    if ( b[0].y === b[1].y ) {
        b[0].y -= 1;
        b[1].y += 1;
    }
    if ( b[0].z === b[1].z ) {
        b[0].z -= 1;
        b[1].z += 1;
    }

    var rxRange = Math.sqrt( Math.pow( b[1].z - b[0].z, 2 )
                            + Math.pow( b[1].y - b[0].y, 2 ) );
    var ryRange = Math.sqrt( Math.pow( b[1].x - b[0].x, 2 )
                            + Math.pow( b[1].z - b[0].z, 2 ) );
    var rzRange = Math.sqrt( Math.pow( b[1].x - b[0].x, 2 )
                            + Math.pow( b[1].y - b[0].y, 2 ) );
    var xRange = b[1].x - b[0].x;
    var yRange = b[1].y - b[0].y;
    var zRange = b[1].z - b[0].z;

    var ar = options.aspectRatio;
    var a = [ ar[0], ar[1], ar[2] ]; // aspect multipliers

    var autoScaling = options.autoScaling;
    var autoAspect = 2.5;
    if ( xRange &gt; autoAspect * rxRange &amp;&amp; autoScaling[0] ) a[0] = autoAspect * rxRange / xRange;
    if ( yRange &gt; autoAspect * ryRange &amp;&amp; autoScaling[1] ) a[1] = autoAspect * ryRange / yRange;
    if ( zRange &gt; autoAspect * rzRange &amp;&amp; autoScaling[2] ) a[2] = autoAspect * rzRange / zRange;

    // Distance from (xMid,yMid,zMid) to any corner of the bounding box, after applying aspectRatio
    var midToCorner = Math.sqrt( a[0]*a[0]*xRange*xRange + a[1]*a[1]*yRange*yRange + a[2]*a[2]*zRange*zRange ) / 2;

    var xMid = ( b[0].x + b[1].x ) / 2;
    var yMid = ( b[0].y + b[1].y ) / 2;
    var zMid = ( b[0].z + b[1].z ) / 2;

    var box = new THREE.Geometry();
    box.vertices.push( new THREE.Vector3( a[0]*b[0].x, a[1]*b[0].y, a[2]*b[0].z ) );
    box.vertices.push( new THREE.Vector3( a[0]*b[1].x, a[1]*b[1].y, a[2]*b[1].z ) );
    var boxMesh = new THREE.Line( box );
    var boxColor = options.theme === &#x27;dark&#x27; ? &#x27;white&#x27; : &#x27;black&#x27;;
    if ( options.frame ) scene.add( new THREE.BoxHelper( boxMesh, boxColor ) );

    if ( options.axesLabels ) {

        var d = options.decimals; // decimals
        var offsetRatio = 0.1;
        var al = options.axesLabels;
        var als = options.axesLabelsStyle || [{}, {}, {}];

        var offset = offsetRatio * a[1]*( b[1].y - b[0].y );
        var xm = xMid.toFixed(d);
        if ( /^-0.?0*$/.test(xm) ) xm = xm.substr(1);
        addLabel( al[0] + &#x27;=&#x27; + xm, a[0]*xMid, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );
        addLabel( ( b[0].x ).toFixed(d), a[0]*b[0].x, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );
        addLabel( ( b[1].x ).toFixed(d), a[0]*b[1].x, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );

        var offset = offsetRatio * a[0]*( b[1].x - b[0].x );
        var ym = yMid.toFixed(d);
        if ( /^-0.?0*$/.test(ym) ) ym = ym.substr(1);
        addLabel( al[1] + &#x27;=&#x27; + ym, a[0]*b[1].x+offset, a[1]*yMid, a[2]*b[0].z, als[1] );
        addLabel( ( b[0].y ).toFixed(d), a[0]*b[1].x+offset, a[1]*b[0].y, a[2]*b[0].z, als[1] );
        addLabel( ( b[1].y ).toFixed(d), a[0]*b[1].x+offset, a[1]*b[1].y, a[2]*b[0].z, als[1] );

        var offset = offsetRatio * a[1]*( b[1].y - b[0].y );
        var zm = zMid.toFixed(d);
        if ( /^-0.?0*$/.test(zm) ) zm = zm.substr(1);
        addLabel( al[2] + &#x27;=&#x27; + zm, a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*zMid, als[2] );
        addLabel( ( b[0].z ).toFixed(d), a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*b[0].z, als[2] );
        addLabel( ( b[1].z ).toFixed(d), a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*b[1].z, als[2] );

    }

    function addLabel( text, x, y, z, style ) {

        var color = style.color || &#x27;black&#x27;;
        var fontSize = style.fontSize || 14;
        var fontFamily = style.fontFamily || &#x27;monospace&#x27;;
        var fontStyle = style.fontStyle || &#x27;normal&#x27;;
        var fontWeight = style.fontWeight || &#x27;normal&#x27;;
        var opacity = style.opacity || 1;

        if ( options.theme === &#x27;dark&#x27; )
            if ( color === &#x27;black&#x27; || color === &#x27;#000000&#x27; )
                color = &#x27;white&#x27;;

        if ( Array.isArray( fontStyle ) ) {
            fontFamily = fontFamily.map( function( f ) {
                // Need to put quotes around fonts that have whitespace in their names.
                return /\s/.test( f ) ? &#x27;&quot;&#x27; + f + &#x27;&quot;&#x27; : f;
            }).join(&#x27;, &#x27;);
        }

        var canvas = document.createElement( &#x27;canvas&#x27; );
        var context = canvas.getContext( &#x27;2d&#x27; );
        var pixelRatio = Math.round( window.devicePixelRatio );

        // For example: italic bold 20px &quot;Times New Roman&quot;, Georgia, serif
        var font = [fontStyle, fontWeight, fontSize + &#x27;px&#x27;, fontFamily].join(&#x27; &#x27;);

        context.font = font;
        var width = context.measureText( text ).width;
        var height = fontSize;

        // The dimensions of the canvas&#x27;s underlying image data need to be powers
        // of two in order for the resulting texture to support mipmapping.
        canvas.width = THREE.MathUtils.ceilPowerOfTwo( width * pixelRatio );
        canvas.height = THREE.MathUtils.ceilPowerOfTwo( height * pixelRatio );

        // Re-compute the unscaled dimensions after the power of two conversion.
        width = canvas.width / pixelRatio;
        height = canvas.height / pixelRatio;

        canvas.style.width = width + &#x27;px&#x27;;
        canvas.style.height = height + &#x27;px&#x27;;

        context.scale( pixelRatio, pixelRatio );
        context.fillStyle = color;
        context.font = font; // Must be set again after measureText.
        context.textAlign = &#x27;center&#x27;;
        context.textBaseline = &#x27;middle&#x27;;
        context.fillText( text, width/2, height/2 );

        var texture = new THREE.Texture( canvas );
        texture.needsUpdate = true;

        var materialOptions = { map: texture, sizeAttenuation: false, depthWrite: false };
        if ( opacity &lt; 1 ) {
            // Setting opacity=1 would cause the texture&#x27;s alpha component to be
            // discarded, giving the text a black background instead of the
            // background being transparent.
            materialOptions.opacity = opacity;
        }
        var sprite = new THREE.Sprite( new THREE.SpriteMaterial( materialOptions ) );
        sprite.position.set( x, y, z );

        // Scaling factor, chosen somewhat arbitrarily so that the size of the text
        // is consistent with previously generated plots.
        var scale = 1/625;
        if ( options.projection === &#x27;orthographic&#x27; ) {
            scale = midToCorner/256; // Needs to scale along with the plot itself.
        }
        sprite.scale.set( scale * width, scale * height, 1 );

        scene.add( sprite );

        return sprite;

    }

    if ( options.axes ) scene.add( new THREE.AxesHelper( Math.min( a[0]*b[1].x, a[1]*b[1].y, a[2]*b[1].z ) ) );

    var camera = createCamera();
    camera.up.set( 0, 0, 1 );
    camera.position.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );

    // camera is positioned so that the line from the camera to the center
    // of the bounding sphere of the objects makes an angle of 60 degrees with x-axis
    // and an angle of 30 degrees with z-axis and the field of view of the camera looking
    // at the center has an angle of 45 degrees.
    const sin8 = Math.sin(Math.PI / 8);
    const sin5 = Math.sin(Math.PI / 5);
    const cos5 = Math.cos(Math.PI / 5);
    const sin3 = Math.sin(Math.PI / 3);
    const cos3 = Math.cos(Math.PI / 3);
    var r = midToCorner / sin8;
    var offset = new THREE.Vector3( r * sin3 * cos5, r * sin3 * sin5, r * cos3 );

    if ( options.viewpoint ) {

        var aa = options.viewpoint;
        var axis = new THREE.Vector3( aa[0][0], aa[0][1], aa[0][2] ).normalize();
        var angle = aa[1] * Math.PI / 180;
        var q = new THREE.Quaternion().setFromAxisAngle( axis, angle ).inverse();

        offset.set( 0, 0, offset.length() );
        offset.applyQuaternion( q );

    }

    camera.position.add( offset );

    function createCamera() {

        var aspect = window.innerWidth / window.innerHeight;

        // Scale the near and far clipping planes along with the overall plot size.
        var nearClip = 0.01 * midToCorner;
        var farClip = 100 * midToCorner;

        if ( options.projection === &#x27;orthographic&#x27; ) {
            var camera = new THREE.OrthographicCamera( -1, 1, 1, -1, -farClip, farClip );
            updateCameraAspect( camera, aspect );
            return camera;
        }

        return new THREE.PerspectiveCamera( 45, aspect, nearClip, farClip );

    }

    function updateCameraAspect( camera, aspect ) {

        if ( camera.isPerspectiveCamera ) {
            camera.aspect = aspect;
        } else if ( camera.isOrthographicCamera ) {
            // Fit the camera frustum to the bounding box&#x27;s diagonal so that the entire plot fits
            // within at the default zoom level and camera position.
            if ( aspect &gt; 1 ) { // Wide window
                camera.top = midToCorner;
                camera.right = midToCorner * aspect;
            } else { // Tall or square window
                camera.top = midToCorner / aspect;
                camera.right = midToCorner;
            }
            camera.bottom = -camera.top;
            camera.left = -camera.right;
        }

        camera.updateProjectionMatrix();

    }

    var lights = [{&quot;x&quot;:-5, &quot;y&quot;:3, &quot;z&quot;:0, &quot;color&quot;:&quot;#7f7f7f&quot;, &quot;parent&quot;:&quot;camera&quot;}];
    for ( var i=0 ; i &lt; lights.length ; i++ ) {
        var light = new THREE.DirectionalLight( lights[i].color, 1 );
        light.position.set( a[0]*lights[i].x, a[1]*lights[i].y, a[2]*lights[i].z );
        if ( lights[i].parent === &#x27;camera&#x27; ) {
            light.target.position.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );
            scene.add( light.target );
            camera.add( light );
        } else scene.add( light );
    }
    scene.add( camera );

    var ambient = {&quot;color&quot;:&quot;#7f7f7f&quot;};
    scene.add( new THREE.AmbientLight( ambient.color, 1 ) );

    var controls = new THREE.OrbitControls( camera, renderer.domElement );
    controls.target.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );
    controls.addEventListener( &#x27;change&#x27;, function() { if ( !animate ) render(); } );

    window.addEventListener( &#x27;resize&#x27;, function() {

        renderer.setSize( window.innerWidth, window.innerHeight );
        updateCameraAspect( camera, window.innerWidth / window.innerHeight );
        if ( window.rescaleFatLines ) rescaleFatLines();
        if ( !animate ) render();

    } );

    var texts = [];
    for ( var i=0 ; i &lt; texts.length ; i++ ) addText( texts[i] );

    function addText( json ) {
        var sprite = addLabel( json.text, a[0]*json.x, a[1]*json.y, a[2]*json.z, json );
        sprite.userData = json;
    }

    var points = [{&quot;point&quot;: [0.0, 0.0, 0.0], &quot;size&quot;: 20.0, &quot;color&quot;: &quot;#6666ff&quot;, &quot;opacity&quot;: 1.0}];
    for ( var i=0 ; i &lt; points.length ; i++ ) addPoint( points[i] );

    function addPoint( json ) {

        var geometry = new THREE.Geometry();
        var v = json.point;
        geometry.vertices.push( new THREE.Vector3( a[0]*v[0], a[1]*v[1], a[2]*v[2] ) );

        var canvas = document.createElement( &#x27;canvas&#x27; );
        canvas.width = 128;
        canvas.height = 128;

        var context = canvas.getContext( &#x27;2d&#x27; );
        context.arc( 64, 64, 64, 0, 2 * Math.PI );
        context.fillStyle = json.color;
        context.fill();

        var texture = new THREE.Texture( canvas );
        texture.needsUpdate = true;

        var transparent = json.opacity &lt; 1 ? true : false;
        var size = camera.isOrthographicCamera ? json.size : json.size/100;
        var material = new THREE.PointsMaterial( { size: size, map: texture,
                                                   transparent: transparent, opacity: json.opacity,
                                                   alphaTest: .1 } );

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var mesh = new THREE.Points( geometry, material );
        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    var lines = [{&quot;points&quot;: [[0.0, 0.0, 0.0], [0.013513513513513514, 0.02702702702702703, 0.04054054054054054], [0.02702702702702703, 0.05405405405405406, 0.08108108108108109], [0.04054054054054054, 0.08108108108108109, 0.12162162162162163], [0.05405405405405406, 0.10810810810810811, 0.16216216216216217], [0.06756756756756757, 0.13513513513513514, 0.20270270270270271], [0.08108108108108109, 0.16216216216216217, 0.24324324324324326], [0.0945945945945946, 0.1891891891891892, 0.28378378378378377], [0.10810810810810811, 0.21621621621621623, 0.32432432432432434], [0.12162162162162163, 0.24324324324324326, 0.3648648648648649], [0.13513513513513514, 0.2702702702702703, 0.40540540540540543], [0.14864864864864866, 0.2972972972972973, 0.44594594594594594], [0.16216216216216217, 0.32432432432432434, 0.4864864864864865], [0.17567567567567569, 0.35135135135135137, 0.5270270270270271], [0.1891891891891892, 0.3783783783783784, 0.5675675675675675], [0.20270270270270271, 0.40540540540540543, 0.6081081081081081], [0.21621621621621623, 0.43243243243243246, 0.6486486486486487], [0.22972972972972974, 0.4594594594594595, 0.6891891891891893], [0.24324324324324326, 0.4864864864864865, 0.7297297297297298], [0.2567567567567568, 0.5135135135135136, 0.7702702702702704], [0.2702702702702703, 0.5405405405405406, 0.8108108108108109], [0.28378378378378377, 0.5675675675675675, 0.8513513513513513], [0.29729729729729726, 0.5945945945945945, 0.8918918918918918], [0.31081081081081074, 0.6216216216216215, 0.9324324324324322], [0.32432432432432423, 0.6486486486486485, 0.9729729729729727], [0.3378378378378377, 0.6756756756756754, 1.0135135135135132], [0.3513513513513512, 0.7027027027027024, 1.0540540540540535], [0.3648648648648647, 0.7297297297297294, 1.094594594594594], [0.3783783783783782, 0.7567567567567564, 1.1351351351351346], [0.39189189189189166, 0.7837837837837833, 1.175675675675675], [0.40540540540540515, 0.8108108108108103, 1.2162162162162153], [0.41891891891891864, 0.8378378378378373, 1.256756756756756], [0.4324324324324321, 0.8648648648648642, 1.2972972972972965], [0.4459459459459456, 0.8918918918918912, 1.3378378378378368], [0.4594594594594591, 0.9189189189189182, 1.3783783783783772], [0.4729729729729726, 0.9459459459459452, 1.4189189189189177], [0.48648648648648607, 0.9729729729729721, 1.4594594594594583], [0.49999999999999956, 0.9999999999999991, 1.4999999999999987], [0.513513513513513, 1.027027027027026, 1.540540540540539], [0.5270270270270265, 1.054054054054053, 1.5810810810810796], [0.54054054054054, 1.08108108108108, 1.6216216216216202], [0.5540540540540535, 1.108108108108107, 1.6621621621621605], [0.567567567567567, 1.135135135135134, 1.7027027027027009], [0.5810810810810805, 1.162162162162161, 1.7432432432432414], [0.594594594594594, 1.189189189189188, 1.783783783783782], [0.6081081081081074, 1.216216216216215, 1.8243243243243223], [0.6216216216216209, 1.2432432432432419, 1.8648648648648627], [0.6351351351351344, 1.2702702702702688, 1.9054054054054033], [0.6486486486486479, 1.2972972972972958, 1.9459459459459438], [0.6621621621621614, 1.3243243243243228, 1.9864864864864842], [0.6756756756756749, 1.3513513513513498, 2.0270270270270245], [0.6891891891891884, 1.3783783783783767, 2.067567567567565], [0.7027027027027019, 1.4054054054054037, 2.1081081081081057], [0.7162162162162153, 1.4324324324324307, 2.148648648648646], [0.7297297297297288, 1.4594594594594577, 2.1891891891891864], [0.7432432432432423, 1.4864864864864846, 2.229729729729727], [0.7567567567567558, 1.5135135135135116, 2.2702702702702675], [0.7702702702702693, 1.5405405405405386, 2.310810810810808], [0.7837837837837828, 1.5675675675675655, 2.351351351351348], [0.7972972972972963, 1.5945945945945925, 2.3918918918918886], [0.8108108108108097, 1.6216216216216195, 2.4324324324324293], [0.8243243243243232, 1.6486486486486465, 2.4729729729729697], [0.8378378378378367, 1.6756756756756734, 2.51351351351351], [0.8513513513513502, 1.7027027027027004, 2.554054054054051], [0.8648648648648637, 1.7297297297297274, 2.594594594594591], [0.8783783783783772, 1.7567567567567544, 2.6351351351351315], [0.8918918918918907, 1.7837837837837813, 2.675675675675672], [0.9054054054054042, 1.8108108108108083, 2.7162162162162122], [0.9189189189189176, 1.8378378378378353, 2.756756756756753], [0.9324324324324311, 1.8648648648648622, 2.7972972972972934], [0.9459459459459446, 1.8918918918918892, 2.8378378378378337], [0.9594594594594581, 1.9189189189189162, 2.8783783783783745], [0.9729729729729716, 1.9459459459459432, 2.918918918918915], [0.9864864864864851, 1.9729729729729701, 2.959459459459455]], &quot;color&quot;: &quot;#0000ff&quot;, &quot;opacity&quot;: 1.0, &quot;linewidth&quot;: 3.0}, {&quot;points&quot;: [[-0.0, 0.0, 0.0], [-0.08108108108108109, 0.04054054054054054, 0.02702702702702703], [-0.16216216216216217, 0.08108108108108109, 0.05405405405405406], [-0.24324324324324326, 0.12162162162162163, 0.08108108108108109], [-0.32432432432432434, 0.16216216216216217, 0.10810810810810811], [-0.40540540540540543, 0.20270270270270271, 0.13513513513513514], [-0.4864864864864865, 0.24324324324324326, 0.16216216216216217], [-0.5675675675675675, 0.28378378378378377, 0.1891891891891892], [-0.6486486486486487, 0.32432432432432434, 0.21621621621621623], [-0.7297297297297298, 0.3648648648648649, 0.24324324324324326], [-0.8108108108108109, 0.40540540540540543, 0.2702702702702703], [-0.8918918918918919, 0.44594594594594594, 0.2972972972972973], [-0.972972972972973, 0.4864864864864865, 0.32432432432432434], [-1.0540540540540542, 0.5270270270270271, 0.35135135135135137], [-1.135135135135135, 0.5675675675675675, 0.3783783783783784], [-1.2162162162162162, 0.6081081081081081, 0.40540540540540543], [-1.2972972972972974, 0.6486486486486487, 0.43243243243243246], [-1.3783783783783785, 0.6891891891891893, 0.4594594594594595], [-1.4594594594594597, 0.7297297297297298, 0.4864864864864865], [-1.5405405405405408, 0.7702702702702704, 0.5135135135135136], [-1.6216216216216217, 0.8108108108108109, 0.5405405405405406], [-1.7027027027027026, 0.8513513513513513, 0.5675675675675675], [-1.7837837837837835, 0.8918918918918918, 0.5945945945945945], [-1.8648648648648645, 0.9324324324324322, 0.6216216216216215], [-1.9459459459459454, 0.9729729729729727, 0.6486486486486485], [-2.0270270270270263, 1.0135135135135132, 0.6756756756756754], [-2.108108108108107, 1.0540540540540535, 0.7027027027027024], [-2.189189189189188, 1.094594594594594, 0.7297297297297294], [-2.2702702702702693, 1.1351351351351346, 0.7567567567567564], [-2.35135135135135, 1.175675675675675, 0.7837837837837833], [-2.4324324324324307, 1.2162162162162153, 0.8108108108108103], [-2.513513513513512, 1.256756756756756, 0.8378378378378373], [-2.594594594594593, 1.2972972972972965, 0.8648648648648642], [-2.6756756756756737, 1.3378378378378368, 0.8918918918918912], [-2.7567567567567544, 1.3783783783783772, 0.9189189189189182], [-2.8378378378378355, 1.4189189189189177, 0.9459459459459452], [-2.9189189189189166, 1.4594594594594583, 0.9729729729729721], [-2.9999999999999973, 1.4999999999999987, 0.9999999999999991], [-3.081081081081078, 1.540540540540539, 1.027027027027026], [-3.162162162162159, 1.5810810810810796, 1.054054054054053], [-3.2432432432432403, 1.6216216216216202, 1.08108108108108], [-3.324324324324321, 1.6621621621621605, 1.108108108108107], [-3.4054054054054017, 1.7027027027027009, 1.135135135135134], [-3.486486486486483, 1.7432432432432414, 1.162162162162161], [-3.567567567567564, 1.783783783783782, 1.189189189189188], [-3.6486486486486447, 1.8243243243243223, 1.216216216216215], [-3.7297297297297254, 1.8648648648648627, 1.2432432432432419], [-3.8108108108108065, 1.9054054054054033, 1.2702702702702688], [-3.8918918918918877, 1.9459459459459438, 1.2972972972972958], [-3.9729729729729684, 1.9864864864864842, 1.3243243243243228], [-4.054054054054049, 2.0270270270270245, 1.3513513513513498], [-4.13513513513513, 2.067567567567565, 1.3783783783783767], [-4.216216216216211, 2.1081081081081057, 1.4054054054054037], [-4.297297297297292, 2.148648648648646, 1.4324324324324307], [-4.378378378378373, 2.1891891891891864, 1.4594594594594577], [-4.459459459459454, 2.229729729729727, 1.4864864864864846], [-4.540540540540535, 2.2702702702702675, 1.5135135135135116], [-4.621621621621616, 2.310810810810808, 1.5405405405405386], [-4.702702702702696, 2.351351351351348, 1.5675675675675655], [-4.783783783783777, 2.3918918918918886, 1.5945945945945925], [-4.864864864864859, 2.4324324324324293, 1.6216216216216195], [-4.945945945945939, 2.4729729729729697, 1.6486486486486465], [-5.02702702702702, 2.51351351351351, 1.6756756756756734], [-5.108108108108102, 2.554054054054051, 1.7027027027027004], [-5.189189189189182, 2.594594594594591, 1.7297297297297274], [-5.270270270270263, 2.6351351351351315, 1.7567567567567544], [-5.351351351351344, 2.675675675675672, 1.7837837837837813], [-5.4324324324324245, 2.7162162162162122, 1.8108108108108083], [-5.513513513513506, 2.756756756756753, 1.8378378378378353], [-5.594594594594587, 2.7972972972972934, 1.8648648648648622], [-5.675675675675667, 2.8378378378378337, 1.8918918918918892], [-5.756756756756749, 2.8783783783783745, 1.9189189189189162], [-5.83783783783783, 2.918918918918915, 1.9459459459459432], [-5.91891891891891, 2.959459459459455, 1.9729729729729701]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0, &quot;linewidth&quot;: 3.0}];
    for ( var i=0 ; i &lt; lines.length ; i++ ) addLine( lines[i] );

    function addLine( json ) {

        var geometry = new THREE.Geometry();
        for ( var i=0 ; i &lt; json.points.length ; i++ ) {
            var v = json.points[i];
            geometry.vertices.push( new THREE.Vector3( a[0]*v[0], a[1]*v[1], a[2]*v[2] ) );
        }

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var transparent = json.opacity &lt; 1 ? true : false;
        var materialOptions = { color: json.color, linewidth: json.linewidth,
                                transparent: transparent, opacity: json.opacity };

        var mesh;
        if ( json.linewidth &gt; 1 &amp;&amp; window.createFatLineStrip ) {
            mesh = createFatLineStrip( geometry, materialOptions );
        } else {
            var material = new THREE.LineBasicMaterial( materialOptions );
            mesh = new THREE.Line( geometry, material );
        }

        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    var surfaces = [{&quot;vertices&quot;: [{&quot;x&quot;: 1.0, &quot;y&quot;: 2.0, &quot;z&quot;: 3.0}, {&quot;x&quot;: 1.0014674870572908, &quot;y&quot;: 1.9760844355594944, &quot;z&quot;: 2.9523914842115038}, {&quot;x&quot;: 0.985150166870676, &quot;y&quot;: 1.9871546462943896, &quot;z&quot;: 2.9504504504504454}, {&quot;x&quot;: 0.9970815736405337, &quot;y&quot;: 1.9607142892847462, &quot;z&quot;: 2.9641002195335884}, {&quot;x&quot;: 0.9780536098906487, &quot;y&quot;: 1.9622852272097897, &quot;z&quot;: 2.9693955821668543}, {&quot;x&quot;: 0.970679594973276, &quot;y&quot;: 1.9786262665164307, &quot;z&quot;: 2.9609595609348847}, {&quot;x&quot;: 0.9864864864864851, &quot;y&quot;: 1.9729729729729701, &quot;z&quot;: 2.959459459459455}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6], [1, 3, 6], [3, 4, 6], [4, 5, 6], [5, 2, 6]], &quot;color&quot;: &quot;#0000ff&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: -6.0, &quot;y&quot;: 3.0, &quot;z&quot;: 2.0}, {&quot;x&quot;: -5.9032828669475785, &quot;y&quot;: 2.976379346841619, &quot;z&quot;: 1.9945012978137204}, {&quot;x&quot;: -5.9099099099099, &quot;y&quot;: 2.986486486486485, &quot;z&quot;: 1.9594594594594552}, {&quot;x&quot;: -5.918264316359777, &quot;y&quot;: 2.942889497920423, &quot;z&quot;: 1.9997917229589175}, {&quot;x&quot;: -5.934150404259576, &quot;y&quot;: 2.932298772653891, &quot;z&quot;: 1.968019547159321}, {&quot;x&quot;: -5.92898709711772, &quot;y&quot;: 2.9592431933948578, &quot;z&quot;: 1.9430928374734366}, {&quot;x&quot;: -5.91891891891891, &quot;y&quot;: 2.959459459459455, &quot;z&quot;: 1.9729729729729701}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6], [1, 3, 6], [3, 4, 6], [4, 5, 6], [5, 2, 6]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}];
    for ( var i=0 ; i &lt; surfaces.length ; i++ ) addSurface( surfaces[i] );

    function addSurface( json ) {

        var useFaceColors = &#x27;faceColors&#x27; in json ? true : false;

        var geometry = new THREE.Geometry();
        for ( var i=0 ; i &lt; json.vertices.length ; i++ ) {
            var v = json.vertices[i];
            geometry.vertices.push( new THREE.Vector3( a[0]*v.x, a[1]*v.y, a[2]*v.z ) );
        }
        for ( var i=0 ; i &lt; json.faces.length ; i++ ) {
            var f = json.faces[i];
            for ( var j=0 ; j &lt; f.length - 2 ; j++ ) {
                var face = new THREE.Face3( f[0], f[j+1], f[j+2] );
                if ( useFaceColors ) face.color.set( json.faceColors[i] );
                geometry.faces.push( face );
            }
        }
        geometry.computeVertexNormals();

        var side = json.singleSide ? THREE.FrontSide : THREE.DoubleSide;
        var transparent = json.opacity &lt; 1 ? true : false;
        var depthWrite = &#x27;depthWrite&#x27; in json ? json.depthWrite : !transparent;
        var flatShading = json.useFlatShading ? json.useFlatShading : false;

        var material = new THREE.MeshPhongMaterial( { side: side,
                                     color: useFaceColors ? &#x27;white&#x27; : json.color,
                                     vertexColors: useFaceColors ? THREE.FaceColors : THREE.NoColors,
                                     transparent: transparent, opacity: json.opacity,
                                     shininess: 20, flatShading: flatShading,
                                     depthWrite: depthWrite } );

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var mesh = new THREE.Mesh( geometry, material );
        mesh.position.set( c.x, c.y, c.z );
        if ( transparent &amp;&amp; json.renderOrder ) mesh.renderOrder = json.renderOrder;
        mesh.userData = json;
        scene.add( mesh );

        if ( json.showMeshGrid ) addSurfaceMeshGrid( json );

    }

    function addSurfaceMeshGrid( json ) {

        var geometry = new THREE.Geometry();

        for ( var i=0 ; i &lt; json.faces.length ; i++ ) {
            var f = json.faces[i];
            for ( var j=0 ; j &lt; f.length ; j++ ) {
                var k = j === f.length-1 ? 0 : j+1;
                var v1 = json.vertices[f[j]];
                var v2 = json.vertices[f[k]];
                // vertices in opposite directions on neighboring faces
                var nudge = f[j] &lt; f[k] ? .0005*zRange : -.0005*zRange;
                geometry.vertices.push( new THREE.Vector3( a[0]*v1.x, a[1]*v1.y, a[2]*(v1.z+nudge) ) );
                geometry.vertices.push( new THREE.Vector3( a[0]*v2.x, a[1]*v2.y, a[2]*(v2.z+nudge) ) );
            }
        }

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var gridColor = options.theme === &#x27;dark&#x27; ? &#x27;white&#x27; : &#x27;black&#x27;;
        var linewidth = json.linewidth || 1;
        var materialOptions = { color: gridColor, linewidth: linewidth };

        var mesh;
        if ( linewidth &gt; 1 &amp;&amp; window.createFatLineSegments ) {
            mesh = createFatLineSegments( geometry, materialOptions );
        } else {
            var material = new THREE.LineBasicMaterial( materialOptions );
            mesh = new THREE.LineSegments( geometry, material );
        }

        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    function render() {

        if ( window.updateAnimation ) animate = updateAnimation();
        if ( animate ) requestAnimationFrame( render );

        renderer.render( scene, camera );

    }

    render();
    controls.update();
    if ( !animate ) render();


    // menu functions

    function toggleMenu() {

        var m = document.getElementById( &#x27;menu-content&#x27; );
        if ( m.style.display === &#x27;block&#x27; ) m.style.display = &#x27;none&#x27;
        else m.style.display = &#x27;block&#x27;;

    }


    function saveAsPNG() {

        var a = document.body.appendChild( document.createElement( &#x27;a&#x27; ) );
        a.href = renderer.domElement.toDataURL( &#x27;image/png&#x27; );
        a.download = &#x27;screenshot&#x27;;
        a.click();

    }

    function saveAsHTML() {

        toggleMenu(); // otherwise visible in output
        event.stopPropagation();

        var blob = new Blob( [ &#x27;&lt;!DOCTYPE html&gt;\n&#x27; + document.documentElement.outerHTML ] );
        var a = document.body.appendChild( document.createElement( &#x27;a&#x27; ) );
        a.href = window.URL.createObjectURL( blob );
        a.download = suggestFilename();
        a.click();

        function suggestFilename() {
            if ( !document.title ) {
                return &#x27;graphic.html&#x27;;
            } else if ( /\.html?$/i.test( document.title ) ) {
                return document.title; // already ends in .htm or .html
            } else {
                return document.title + &#x27;.html&#x27;;
            }
        }

    }

    function getViewpoint() {

        function roundTo( x, n ) { return +x.toFixed(n); }

        var v = camera.quaternion.inverse();
        var r = Math.sqrt( v.x*v.x + v.y*v.y + v.z*v.z );
        var axis = [ roundTo( v.x / r, 4 ), roundTo( v.y / r, 4 ), roundTo( v.z / r, 4 ) ];
        var angle = roundTo( 2 * Math.atan2( r, v.w ) * 180 / Math.PI, 2 );

        var textArea = document.createElement( &#x27;textarea&#x27; );
        textArea.textContent = JSON.stringify( axis ) + &#x27;,&#x27; + angle;
        textArea.style.csstext = &#x27;position: absolute; top: -100%&#x27;;
        document.body.append( textArea );
        textArea.select();
        document.execCommand( &#x27;copy&#x27; );

        var m = document.getElementById( &#x27;menu-message&#x27; );
        m.innerHTML = &#x27;Viewpoint copied to clipboard&#x27;;
        m.style.display = &#x27;block&#x27;;
        setTimeout( function() { m.style.display = &#x27;none&#x27;; }, 2000 );

    }

    function getCamera() {

        function roundTo( x, n ) { return +x.toFixed(n); }

        var pos = camera.position;
        var pos_r = [ roundTo( pos.x, 4 ), roundTo( pos.y, 4 ), roundTo( pos.z, 4 ) ];
   //     var up = camera.up; // up is always (0,0,1)
        var textArea = document.createElement(&#x27;textarea&#x27;);
        var cam_position = JSON.stringify(pos_r);
        textArea.textContent = &#x27;,camera_position=&#x27; + cam_position;
        textArea.style.csstext = &#x27;position: absolute; top: -100%&#x27;;
        document.body.append( textArea );
        textArea.select();
        document.execCommand( &#x27;copy&#x27; );

        var m = document.getElementById( &#x27;menu-message&#x27; );
        m.innerHTML = &#x27;Camera position &#x27;+ cam_position+&#x27; copied to clipboard&#x27;;
        m.style.display = &#x27;block&#x27;;
        setTimeout( function() { m.style.display = &#x27;none&#x27;; }, 2000 );

    }

&lt;/script&gt;

&lt;div id=&quot;menu-container&quot; onclick=&quot;toggleMenu()&quot;&gt;&amp;#x24d8;
&lt;div id=&quot;menu-message&quot;&gt;&lt;/div&gt;
&lt;div id=&quot;menu-content&quot;&gt;
&lt;div onclick=&quot;saveAsPNG()&quot;&gt;Save as PNG&lt;/div&gt;
&lt;div onclick=&quot;saveAsHTML()&quot;&gt;Save as HTML&lt;/div&gt;
&lt;div onclick=&quot;getCamera()&quot;&gt;Get camera&lt;/div&gt;
&lt;div onclick=&quot;getViewpoint()&quot;&gt;Get viewpoint&lt;/div&gt;
&lt;div&gt;Close Menu&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;/body&gt;
&lt;/html&gt;
"
        width="100%"
        height="400"
        style="border: 0;">
</iframe>
</div></div>
</div>
<p style="text-align: center;">
    (You can interactively rotate, zoom, and pan the above 3D plots using the mouse)
</p><p>This example demonstrates the concept of orthogonality in three-dimensional space:</p>
<ol class="arabic simple">
<li><p><strong>Vector Definition:</strong> Two vectors are defined:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">u</span> <span class="pre">=</span> <span class="pre">vector([1,</span> <span class="pre">2,</span> <span class="pre">3])</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v</span> <span class="pre">=</span> <span class="pre">vector([-6,</span> <span class="pre">3,</span> <span class="pre">2])</span></code></p></li>
</ul>
</li>
<li><p><strong>Dot Product Calculation:</strong> The dot product of the two vectors is calculated:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dot_product</span> <span class="pre">=</span> <span class="pre">u.dot_product(v)</span></code></p></li>
</ul>
</li>
<li><p><strong>Output:</strong> The output is:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Dot</span> <span class="pre">Product</span> <span class="pre">(u⋅v):</span> <span class="pre">0</span></code></p></li>
</ul>
</li>
<li><p><strong>Visualization:</strong> The vectors are plotted as arrows originating from the origin (0, 0, 0) in a 3D graph:</p>
<ul class="simple">
<li><p>The blue arrow represents vector <code class="docutils literal notranslate"><span class="pre">u</span></code>.</p></li>
<li><p>The red arrow represents vector <code class="docutils literal notranslate"><span class="pre">v</span></code>.</p></li>
</ul>
</li>
</ol>
<p><strong>Why This Example is Important for Orthogonality</strong></p>
<ul class="simple">
<li><p><strong>Zero Dot Product:</strong> The key result of this example is that the dot product of the vectors <code class="docutils literal notranslate"><span class="pre">u</span></code> and <code class="docutils literal notranslate"><span class="pre">v</span></code> is zero. In linear algebra, a zero dot product is the defining characteristic of orthogonal (perpendicular) vectors. This means the angle between <code class="docutils literal notranslate"><span class="pre">u</span></code> and <code class="docutils literal notranslate"><span class="pre">v</span></code> is 90 degrees (a right angle).</p></li>
<li><p><strong>Geometric Interpretation:</strong> The 3D visualization reinforces the geometric meaning of orthogonality. By observing the plot, you can clearly see that the blue and red arrows (representing the vectors) intersect at a right angle. This visual confirmation helps solidify the concept that orthogonal vectors are perpendicular in space.</p></li>
<li><p><strong>Generalization:</strong> While this example deals with specific vectors in 3D space, the principle it illustrates is general. Any two vectors in any dimension are orthogonal if and only if their dot product is zero.</p></li>
<li><p><strong>Applications:</strong> Orthogonality is a fundamental concept in many areas of linear algebra and its applications. For example, orthogonal bases (sets of mutually orthogonal vectors) simplify calculations, orthogonal matrices preserve lengths and angles during transformations, and orthogonal projections are used in various algorithms.</p></li>
</ul>
</section>
<section id="example-4-orthogonal-basis">
<h3>Example 4: Orthogonal Basis<a class="headerlink" href="#example-4-orthogonal-basis" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Example 4: Orthogonal Basis</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matrix A:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Find an orthogonal basis for the column space of A using Gram-Schmidt</span>
<span class="n">orthogonal_basis</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">()</span>  

<span class="c1"># Convert the basis (list of vectors) back to a matrix for better display</span>
<span class="n">orthogonal_basis_matrix</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">orthogonal_basis</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Orthogonal Basis:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">orthogonal_basis_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Example 4: Orthogonal Basis

Matrix A:
</pre></div>
</div>
<div class="output text_html"><html>\(\displaystyle \left(\begin{array}{rrr}
1 & 2 & 3 \\
-1 & 0 & 1 \\
0 & 1 & 2
\end{array}\right)\)</html></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Orthogonal Basis:
</pre></div>
</div>
<div class="output text_html"><html>\(\displaystyle \left(\begin{array}{rrr}
1 & 2 & 3 \\
-\frac{8}{7} & -\frac{2}{7} & \frac{4}{7}
\end{array}\right)\)</html></div></div>
</div>
<p>Let’s break down Example 4 and its significance in the context of orthogonality.</p>
<ol class="arabic simple">
<li><p><strong>Matrix Definition:</strong> It starts by defining a matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> with the following elements:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>
<span class="o">-</span><span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">1</span>
 <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p><strong>Gram-Schmidt Orthogonalization:</strong> It then applies the Gram-Schmidt process to the columns of matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>. This process is a systematic way to take a set of linearly independent vectors (the columns of <code class="docutils literal notranslate"><span class="pre">A</span></code> in this case) and transform them into an orthogonal set of vectors.  This orthogonal set still spans the same space as the original columns.</p></li>
<li><p><strong>Result:</strong> The output of <code class="docutils literal notranslate"><span class="pre">A.gram_schmidt()</span></code> is a tuple. The first element of this tuple is the orthogonal basis, which is a list of vectors. The second element is a change-of-basis matrix (which we discard in this example using <code class="docutils literal notranslate"><span class="pre">_</span></code>).</p></li>
<li><p><strong>Display:</strong>  For a more intuitive display, the orthogonal basis (which is initially a list of vectors) is converted back into a matrix <code class="docutils literal notranslate"><span class="pre">orthogonal_basis_matrix</span></code> and then printed.</p></li>
</ol>
<p><strong>Why Example 3 is Important for Orthogonality:</strong></p>
<ul class="simple">
<li><p><strong>Orthogonal Bases are Convenient:</strong> Orthogonal bases make many computations in linear algebra much simpler.  For example, projecting a vector onto a subspace becomes a straightforward calculation when the subspace has an orthogonal basis.</p></li>
<li><p><strong>Applications:</strong> Orthogonal bases have numerous applications in various fields:</p>
<ul>
<li><p><strong>Least Squares Approximation:</strong> Used to find the best fit line or curve to a set of data points.</p></li>
<li><p><strong>Fourier Series:</strong>  The Fourier series is an infinite sum of orthogonal functions used to represent periodic signals.</p></li>
<li><p><strong>Quantum Mechanics:</strong> Orthogonal basis states are fundamental to describing quantum systems.</p></li>
<li><p><strong>Numerical Linear Algebra:</strong> Many algorithms for solving linear equations and eigenvalue problems rely on orthogonal matrices.</p></li>
</ul>
</li>
<li><p><strong>Gram-Schmidt:</strong> The Gram-Schmidt process is a fundamental tool for constructing orthogonal bases, making it essential to understand orthogonality in linear algebra.</p></li>
</ul>
<p><strong>In Summary:</strong></p>
<p>Example 4 demonstrates how to use the Gram-Schmidt process in SageMath to obtain an orthogonal basis from a given set of vectors (the columns of a matrix).  This is an important skill because orthogonal bases simplify calculations and have widespread applications in both theoretical and applied mathematics.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "sagemath"
        },
        kernelOptions: {
            name: "sagemath",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'sagemath'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="14-projections.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Projections</p>
      </div>
    </a>
    <a class="right-next"
       href="16-determinants.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Determinants</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-test-orthogonality">Example 1: Test orthogonality</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-orthogonal-vectors-in-2d">Example 2: Orthogonal Vectors in 2D</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-orthogonal-vectors-in-3d">Example 3: Orthogonal Vectors in 3D</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-4-orthogonal-basis">Example 4: Orthogonal Basis</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Chris Snow
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>